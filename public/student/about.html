<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About | UBigkas</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ===== TEXT SCALING VARIABLE ===== */
        :root {
            --text-scale: 100%;
            --maroon: #7a0c0c;
            --gold: #d4af37;
            --bg: #f8f9fa;
            --card-bg: #fff;
            --nav-text: #333;
            --white: #ffffff;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --danger: #d9534f;
            --success: #28a745;
            --warning: #ffc107;
        }

        body {
            font-size: var(--text-scale);
            transition: background-color 0.3s ease;
            margin: 0;
            overflow-x: hidden;
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg);
            color: var(--nav-text);
        }

        /* ===== DRIP EFFECT ===== */
        #drip-container { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            pointer-events: none; 
            z-index: 10000; 
        }
        .drip-layer { 
            position: absolute; 
            top: -110%; 
            left: 0; 
            width: 100%; 
            height: 120%; 
            background-color: #181818; 
            transition: top 0.7s cubic-bezier(0.645, 0.045, 0.355, 1); 
            clip-path: url(#drip-path); 
        }
        #drip-container.active .drip-layer { 
            top: 0; 
        }
        .drip-light { 
            background-color: #fdfdfd !important; 
        }

        /* ===== EXACT COPY OF STUDENT DASHBOARD NAVIGATION ===== */
        nav {
            display: flex;
            align-items: center;
            padding: 0 5%;
            height: 80px;
            background-color: var(--maroon);
            border-bottom: 3px solid var(--gold);
            box-shadow: 0px 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav .logo { 
            font-size: 1.8rem; 
            font-weight: 800; 
            text-decoration: none; 
            color: var(--white);
            margin-right: 40px;
        }
        nav .logo span { 
            color: var(--gold); 
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
            margin: 0;
            padding: 0;
        }

        .nav-links li a {
            text-decoration: none;
            color: var(--white);
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links li a:hover { color: var(--gold); }

        .nav-actions { 
            margin-left: auto; 
            position: relative; 
            display: flex; 
            align-items: center; 
        }

        /* ===== BURGER MENU BUTTON (EXACT SAME AS STUDENT DASHBOARD) ===== */
        .burger-menu {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            background: none;
            border: none;
            padding: 10px;
            z-index: 1002;
            margin-right: 15px;
        }
        .burger-menu span {
            width: 25px;
            height: 3px;
            background-color: var(--white);
            border-radius: 2px;
            transition: 0.3s;
        }

        /* ===== SETTINGS DROPDOWN (EXACT SAME AS STUDENT DASHBOARD) ===== */
        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            min-width: 200px;
            margin-top: 15px;
            box-shadow: 0px 8px 16px rgba(0,0,0,0.15);
            border-radius: 12px;
            z-index: 9999;
            overflow: hidden;
            border: 1px solid #eee;
        }
        .dropdown-content.is-active { display: block; }
        .dropdown-content button {
            width: 100%;
            padding: 12px 16px;
            text-align: left;
            border: none;
            background: none;
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.2s;
            color: #333;
        }
        .dropdown-content button:hover { background-color: #f8f9fa; }
        #logoutBtn { color: var(--danger) !important; font-weight: 700; }
        #changePasswordBtn { color: var(--maroon) !important; }

        /* Mobile Side Drawer (EXACT SAME AS STUDENT DASHBOARD) */
        .mobile-menu {
            position: fixed;
            top: 0;
            left: -100%;
            width: 280px;
            height: 100vh;
            background-color: var(--card-bg);
            display: flex;
            flex-direction: column;
            padding: 100px 30px 30px;
            box-shadow: 10px 0 20px rgba(0,0,0,0.1);
            transition: left 0.4s cubic-bezier(0.77, 0, 0.175, 1);
            z-index: 1001;
            margin: 0;
            list-style: none;
        }
        .mobile-menu.show { left: 0; }
        .mobile-menu li a { 
            display: block; 
            padding: 15px 0; 
            text-decoration: none; 
            color: var(--nav-text); 
            font-weight: 500; 
        }
        .mobile-menu button { 
            width: 100%; 
            padding: 12px; 
            margin-top: 10px; 
            text-align: left;
            background: #f1f1f1; 
            border: none; 
            border-radius: 8px; 
            font-family: inherit; 
            cursor: pointer;
        }

        /* ===== DARK MODE STYLES (EXACT SAME AS STUDENT DASHBOARD) ===== */
        body.dark-mode { 
            background-color: #181818; 
            color: #ffffff; 
            --bg: #181818;
            --card-bg: #1e1e1e;
            --nav-text: #ffffff;
        }

        body.dark-mode nav { background-color: #202020; border-bottom-color: var(--gold); }
        body.dark-mode nav .logo { color: var(--white); }
        body.dark-mode .nav-links li a { color: var(--white); }
        body.dark-mode .dropdown-content { 
            background-color: #242424; 
            border: 1px solid #333; 
        }
        body.dark-mode .dropdown-content button { color: #e6e6e6; }
        body.dark-mode .dropdown-content button:hover { background-color: #333; }
        body.dark-mode .burger-menu span { background-color: var(--white); }
        body.dark-mode .mobile-menu { background-color: #1e1e1e; }
        body.dark-mode .mobile-menu button { background: #2a2a2a; color: white; }
        body.dark-mode .container .card,
        body.dark-mode .modal-card {
            background-color: #242424; 
            color: #e6e6e6; 
            border: 1px solid #333;
        }

        /* ===== MOBILE RESPONSIVE (EXACT SAME AS STUDENT DASHBOARD) ===== */
        @media (max-width: 850px) {
            .burger-menu { display: flex; }
            .nav-links, .nav-actions { display: none; }
            nav .logo { margin-right: auto; }
            
            nav {
                height: 70px;
                padding: 0 20px;
            }

            nav .logo {
                font-size: 1.5rem;
            }

            .container { 
                margin: 30px auto; 
                padding: 0 15px; 
            }
            h1 { 
                font-size: 1.8rem !important; 
            }
            #featureDeck { 
                padding: 25px 20px; 
                min-height: 320px; 
            }
            .carousel-btns { 
                flex-direction: row; 
                width: 100%; 
            }
        }

        /* ===== CAROUSEL & CONTENT (ORIGINAL - NO CHANGES) ===== */
        .container { 
            max-width: 900px; 
            margin: 60px auto; 
            padding: 0 20px; 
            text-align: center; 
        }
        #featureDeck { 
            position: relative; 
            min-height: 250px; 
            background: var(--card-bg); 
            border-radius: 20px; 
            padding: 40px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
            transition: background 0.3s ease; 
            margin-bottom: 30px;
        }
        .feature-card { 
            display: none; 
        }
        .feature-card.active { 
            display: block; 
            animation: fadeIn 0.5s ease; 
        }
        @keyframes fadeIn { 
            from { 
                opacity: 0; 
                transform: translateY(10px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        }
        .carousel-btns { 
            margin-top: 30px; 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
        }
        .btn-action { 
            padding: 12px 25px; 
            border-radius: 50px; 
            border: none; 
            cursor: pointer; 
            font-weight: 600; 
            transition: transform 0.2s; 
        }
        
        /* Modal Styles (EXACT SAME AS STUDENT DASHBOARD) */
        .modal-overlay { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0, 0, 0, 0.7); 
            z-index: 20000; 
            justify-content: center; 
            align-items: center; 
            backdrop-filter: blur(4px); 
        }
        .modal-card { 
            background: var(--card-bg); 
            padding: 30px; 
            border-radius: 20px; 
            text-align: center; 
            width: 90%; 
            max-width: 400px; 
        }
        .modal-actions { 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
            margin-top: 20px; 
        }
        .modal-btn { 
            padding: 10px 25px; 
            border-radius: 25px; 
            border: none; 
            font-weight: 600; 
            cursor: pointer; 
            font-family: 'Poppins', sans-serif; 
        }
        .modal-btn.primary { 
            background-color: var(--danger); 
            color: white; 
        }
        .modal-btn.secondary { 
            background-color: #e9ecef; 
            color: #333; 
        }
        body.dark-mode .modal-btn.secondary { 
            background-color: #333; 
            color: #fff; 
        }

        .footer-credit { 
            text-align: center; 
            padding: 20px; 
            color: #888; 
            font-size: 0.8rem; 
        }
        body.dark-mode .footer-credit { 
            color: #777; 
        }

        /* Settings button styling to match student dashboard (EXACT SAME) */
        #settingsBtn {
            padding: 8px 20px;
            border-radius: 25px;
            background-color: var(--white);
            color: var(--maroon);
            font-weight: 600;
            border: 2px solid var(--white);
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        #settingsBtn:hover {
            background-color: rgba(255, 255, 255, 0.9);
        }
        body.dark-mode #settingsBtn {
            background-color: #2a2a2a;
            color: var(--white);
            border-color: #444;
        }
    </style>
</head>
<body>

<div id="drip-container">
    <div id="dripLayer" class="drip-layer"></div>
    <svg width="0" height="0">
        <defs>
            <clipPath id="drip-path" clipPathUnits="objectBoundingBox">
                <path d="M0,0 L1,0 L1,0.8 C0.9,0.95 0.85,0.7 0.75,0.85 C0.65,1 0.55,0.75 0.5,0.9 C0.45,0.75 0.35,1 0.25,0.85 C0.15,0.7 0.1,0.95 0,0.8 Z"></path>
            </clipPath>
        </defs>
    </svg>
</div>

<!-- EXACT COPY OF STUDENT DASHBOARD NAVIGATION -->
<nav>
  <button class="burger-menu" id="burgerBtn">
    <span></span><span></span><span></span>
  </button>

  <a href="student_dashboard.html" class="logo">UB<span>igkas</span></a>
  
  <!-- Desktop Navigation -->
  <ul class="nav-links" id="navLinks">
    <li><a href="student_dashboard.html">Home</a></li>
    <li><a href="grammar_corrector.html">Grammar Corrector</a></li>
    <li><a href="about.html" style="color: var(--gold);">About</a></li>
    <li><a href="contact.html">Contact</a></li>
  </ul>

  <div class="nav-actions">
    <button id="settingsBtn">Settings ‚öôÔ∏è</button>
    <div class="dropdown-content" id="settingsDropdown">
      <button id="darkModeBtn">üåô Dark Mode</button>
      <button id="textSizeBtn">üîç Text Size: 100%</button>
      <button id="changePasswordBtn">üîê Change Password</button>
      <hr style="border: 0; border-top: 1px solid #eee; margin: 5px 0;">
      <button id="logoutBtn">üö™ Logout</button>
    </div>
  </div>
</nav>

<!-- Mobile Menu (EXACT SAME AS STUDENT DASHBOARD) -->
<ul class="mobile-menu" id="mobileMenu">
  <li><a href="student_dashboard.html">Home</a></li>
  <li><a href="grammar_corrector.html">Grammar Corrector</a></li>
  <li><a href="about.html" style="color: var(--gold);">About</a></li>
  <li><a href="contact.html">Contact</a></li>
  <div style="margin-top:20px; border-top:1px solid #eee; padding-top:20px;">
    <button id="mobileDarkModeBtn">üåô Dark Mode</button>
    <button id="mobileTextSizeBtn">üîç Text Size: 100%</button>
    <button id="mobileChangePasswordBtn">üîê Change Password</button>
    <button id="mobileLogoutBtn" style="color:var(--danger);">üö™ Logout</button>
  </div>
</ul>

<!-- LOGOUT MODAL (EXACT SAME AS STUDENT DASHBOARD) -->
<div id="logoutModal" class="modal-overlay">
  <div class="modal-card">
    <h3>Logout Confirmation</h3>
    <p>Are you sure you want to logout?</p>
    <div class="modal-actions">
      <button id="cancelLogout" class="modal-btn secondary">Cancel</button>
      <button id="confirmLogout" class="modal-btn primary">Logout</button>
    </div>
  </div>
</div>

<!-- CHANGE PASSWORD MODAL (EXACT SAME AS STUDENT DASHBOARD) -->
<div id="changePasswordModal" class="modal-overlay">
  <div class="modal-card">
    <h3>Change Password</h3>
    <form id="changePasswordForm">
      <div class="form-group">
        <label>Current Password</label>
        <input type="password" id="currentPassword" required>
      </div>
      <div class="form-group">
        <label>New Password</label>
        <input type="password" id="newPassword" required minlength="6">
      </div>
      <div class="form-group">
        <label>Confirm New Password</label>
        <input type="password" id="confirmPassword" required>
      </div>
      <div class="modal-actions">
        <button type="button" id="cancelPasswordChange" class="modal-btn secondary">Cancel</button>
        <button type="submit" class="modal-btn primary">Change Password</button>
      </div>
    </form>
  </div>
</div>

<!-- ORIGINAL ABOUT PAGE CONTENT (NO CHANGES) -->
<div class="container">
    <h1 style="color:var(--maroon); font-size: 2.5rem; margin-bottom: 10px;">About UBigkas</h1>
    <p style="font-weight: 600; color: #555;" id="missionSub">Wika Natin, Pagyamanin sa Makabagong Panahon.</p>
    
    <div style="text-align: left; margin: 40px 0; line-height: 1.8;">
        <p><strong>UBigkas</strong> is a dedicated language learning initiative born out of the University of Batangas. Our platform serves as a bridge between the foundational rules of Filipino grammar and the fast-paced demands of modern communication.</p>
        <p>Whether you are a student looking to perfect your sentence construction or an enthusiast wanting to dive deeper into the nuances of Tagalog, UBigkas provides the digital tools necessary to make learning intuitive, accurate, and engaging.</p>
    </div>

    <div id="featureDeck">
        <div class="feature-card active">
            <h2 style="color:var(--maroon)">Comprehensive Assessments</h2>
            <p>Our interactive quiz engine goes beyond simple multiple-choice questions. We offer modules covering <strong>Verb Conjugation</strong> and <strong>Noun Classification</strong>.</p>
        </div>
        <div class="feature-card">
            <h2 style="color:var(--maroon)">Grammar & Speech Tools</h2>
            <p>Refine your language skills with our <strong>Grammar Corrector</strong> and integrated <strong>Speech-to-Text</strong> features.</p>
        </div>
        <div class="feature-card">
            <h2 style="color:var(--maroon)">Personalized Learning Paths</h2>
            <p>UBigkas tracks your performance over time, generating a <strong>Performance Dashboard</strong> that highlights your strengths.</p>
        </div>
    </div>

    <div class="carousel-btns">
        <button id="prevBtn" class="btn-action">‚Üê Previous</button>
        <button id="nextBtn" class="btn-action" style="background:var(--maroon); color:white;">Learn More ‚Üí</button>
    </div>
</div>

<div class="footer-credit">¬©2025 University of Batangas ‚Äì Lipa City</div>

<script type="module">
    import { auth, db } from "../firebase.js";
    import { onAuthStateChanged, signOut, updatePassword, reauthenticateWithCredential, EmailAuthProvider } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { doc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const studentName = sessionStorage.getItem("studentName") || "Student";
    const studentUID  = sessionStorage.getItem("studentUID");
    const classId     = sessionStorage.getItem("classId");

    /* ===================== NAVIGATION LOGIC (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    const burgerBtn = document.getElementById("burgerBtn");
    const mobileMenu = document.getElementById("mobileMenu");
    const settingsBtn = document.getElementById("settingsBtn");
    const dropdownMenu = document.getElementById("settingsDropdown");

    // Toggle Mobile Menu (Exact same as student dashboard)
    burgerBtn.onclick = (e) => {
        e.stopPropagation();
        mobileMenu.classList.toggle("show");
    };

    // Toggle Settings Dropdown (Exact same as student dashboard)
    settingsBtn.onclick = (e) => {
        e.stopPropagation();
        dropdownMenu.classList.toggle("is-active");
    };

    // Close menus on outside click (Exact same as student dashboard)
    document.addEventListener('click', (event) => {
        if (!settingsBtn.contains(event.target)) {
            dropdownMenu.classList.remove("is-active");
        }
        if (!burgerBtn.contains(event.target) && !mobileMenu.contains(event.target)) {
            mobileMenu.classList.remove("show");
        }
    });

    /* ===================== TEXT SIZE LOGIC (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    const textSizeBtn = document.getElementById("textSizeBtn");
    const mobileTextSizeBtn = document.getElementById("mobileTextSizeBtn");
    const sizes = ["100%", "115%", "130%"];
    let currentSizeIndex = sizes.indexOf(localStorage.getItem("textSize") || "100%");
    if(currentSizeIndex === -1) currentSizeIndex = 0;

    function updateTextSize() {
      const newSize = sizes[currentSizeIndex];
      document.documentElement.style.setProperty('--text-scale', newSize);
      textSizeBtn.textContent = `üîç Text Size: ${newSize}`;
      mobileTextSizeBtn.textContent = `üîç Text Size: ${newSize}`;
      localStorage.setItem("textSize", newSize);
    }

    // Desktop text size button
    textSizeBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      currentSizeIndex = (currentSizeIndex + 1) % sizes.length;
      updateTextSize();
    });

    // Mobile text size button
    mobileTextSizeBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      currentSizeIndex = (currentSizeIndex + 1) % sizes.length;
      updateTextSize();
      mobileMenu.classList.remove("show");
    });

    updateTextSize();

    /* ===================== THEME SWITCHER (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    const darkModeBtn = document.getElementById("darkModeBtn");
    const mobileDarkModeBtn = document.getElementById("mobileDarkModeBtn");
    const dripContainer = document.getElementById("drip-container");
    const dripLayer = document.getElementById("dripLayer");

    function updateThemeText(isDark) {
        const text = isDark ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
        darkModeBtn.textContent = text;
        mobileDarkModeBtn.textContent = text;
    }

    function toggleTheme() {
      const isDark = document.body.classList.contains("dark-mode");
      if (isDark) dripLayer.classList.add("drip-light");
      else dripLayer.classList.remove("drip-light");

      dripContainer.classList.add("active");

      setTimeout(() => {
        document.body.classList.toggle("dark-mode");
        const nowDark = document.body.classList.contains("dark-mode");
        updateThemeText(nowDark);
        localStorage.setItem("theme", nowDark ? "dark" : "light");
      }, 350);

      setTimeout(() => { dripContainer.classList.remove("active"); }, 700);
    }

    // Desktop theme toggle
    darkModeBtn.onclick = (e) => {
      e.stopPropagation();
      toggleTheme();
      dropdownMenu.classList.remove("is-active");
    };

    // Mobile theme toggle
    mobileDarkModeBtn.onclick = (e) => {
      e.stopPropagation();
      toggleTheme();
      mobileMenu.classList.remove("show");
    };

    if (localStorage.getItem("theme") === "dark") {
      document.body.classList.add("dark-mode");
      updateThemeText(true);
    } else {
      updateThemeText(false);
    }

    /* ===================== CHANGE PASSWORD LOGIC (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    const changePasswordBtn = document.getElementById("changePasswordBtn");
    const mobileChangePasswordBtn = document.getElementById("mobileChangePasswordBtn");
    const changePasswordModal = document.getElementById("changePasswordModal");
    const cancelPasswordChange = document.getElementById("cancelPasswordChange");
    const changePasswordForm = document.getElementById("changePasswordForm");

    function openChangePasswordModal() {
        changePasswordModal.style.display = "flex";
        dropdownMenu.classList.remove("is-active");
        mobileMenu.classList.remove("show");
    }

    // Desktop change password button
    changePasswordBtn.onclick = (e) => {
        e.stopPropagation();
        openChangePasswordModal();
    };

    // Mobile change password button
    mobileChangePasswordBtn.onclick = (e) => {
        e.stopPropagation();
        openChangePasswordModal();
    };

    cancelPasswordChange.onclick = () => {
        changePasswordModal.style.display = "none";
        changePasswordForm.reset();
    };

    changePasswordForm.onsubmit = async (e) => {
        e.preventDefault();
        
        const currentPassword = document.getElementById("currentPassword").value;
        const newPassword = document.getElementById("newPassword").value;
        const confirmPassword = document.getElementById("confirmPassword").value;
        
        // Validation
        if (newPassword !== confirmPassword) {
            alert("New passwords do not match!");
            return;
        }
        
        if (newPassword.length < 6) {
            alert("Password must be at least 6 characters long!");
            return;
        }
        
        try {
            const user = auth.currentUser;
            
            if (!user.email) {
                alert("User email not found. Please contact support.");
                return;
            }
            
            // Re-authenticate user
            const credential = EmailAuthProvider.credential(user.email, currentPassword);
            await reauthenticateWithCredential(user, credential);
            
            // Update password
            await updatePassword(user, newPassword);
            
            alert("Password changed successfully!");
            changePasswordModal.style.display = "none";
            changePasswordForm.reset();
            
        } catch (error) {
            console.error("Password change error:", error);
            
            if (error.code === 'auth/wrong-password') {
                alert("Current password is incorrect!");
            } else if (error.code === 'auth/weak-password') {
                alert("New password is too weak. Please use a stronger password.");
            } else {
                alert("Error changing password: " + error.message);
            }
        }
    };

    /* ===================== AUTH & STATUS (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    async function setStudentStatus(uid, status) {
      try {
        const studentRef = doc(db, "students", uid);
        await updateDoc(studentRef, { status: status, lastSeen: serverTimestamp() });
      } catch (err) { console.error("Status update failed:", err); }
    }

    onAuthStateChanged(auth, async user => {
      if (!user || !studentUID) { window.location.href = "../index.html"; }
      else { await setStudentStatus(studentUID, "online"); }
    });

    /* ===================== LOGOUT LOGIC (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    const logoutBtn = document.getElementById("logoutBtn");
    const mobileLogoutBtn = document.getElementById("mobileLogoutBtn");
    const logoutModal = document.getElementById("logoutModal");
    const cancelLogout = document.getElementById("cancelLogout");
    const confirmLogout = document.getElementById("confirmLogout");

    function openLogoutModal() {
        logoutModal.style.display = "flex";
        dropdownMenu.classList.remove("is-active");
        mobileMenu.classList.remove("show");
    }

    // Desktop logout button
    logoutBtn.addEventListener('click', (e) => { 
        e.stopPropagation(); 
        openLogoutModal();
    });

    // Mobile logout button
    mobileLogoutBtn.addEventListener('click', (e) => { 
        e.stopPropagation(); 
        openLogoutModal();
    });

    cancelLogout.onclick = () => { logoutModal.style.display = "none"; };

    confirmLogout.onclick = async () => {
      if (studentUID) await setStudentStatus(studentUID, "offline");
      await signOut(auth);
      sessionStorage.clear();
      window.location.href = "../index.html";
    };

    /* ===================== CAROUSEL LOGIC (ORIGINAL - NO CHANGES) ===== */
    const cards = document.querySelectorAll('.feature-card');
    let idx = 0;
    document.getElementById('nextBtn').onclick = () => { 
        cards[idx].classList.remove('active'); 
        idx = (idx + 1) % cards.length; 
        cards[idx].classList.add('active'); 
    };
    document.getElementById('prevBtn').onclick = () => { 
        cards[idx].classList.remove('active'); 
        idx = (idx - 1 + cards.length) % cards.length; 
        cards[idx].classList.add('active'); 
    };

    /* ===================== MODAL CLOSE LOGIC (EXACT SAME AS STUDENT DASHBOARD) ===================== */
    window.onclick = (event) => { 
        if (event.target == logoutModal) logoutModal.style.display = "none";
        if (event.target == changePasswordModal) {
            changePasswordModal.style.display = "none";
            changePasswordForm.reset();
        }
    };

    window.addEventListener("beforeunload", () => { if (studentUID) setStudentStatus(studentUID, "offline"); });
</script>
</body>
</html>